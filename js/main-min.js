!function($){window.scrollTo(0,0),setTimeout((function(){o.play()}),1e3),$(document).ready((function(){new jBox("Tooltip",{attach:".tooltip",trigger:"click",closeOnMouseleave:!1,closeButton:!0,maxWidth:350,position:{x:"center",y:"top"},offset:{x:0,y:-10},animation:"move"});const t=document.getElementById("canvas"),o=t.getContext("2d"),n=450,a=e=>`img/this/sequence/frame_${e.toString().padStart(4,"0")}.webp`,i=[],s={frame:0};let r=!1;new ScrollMagic.Scene({triggerElement:"#test",triggerHook:.5}).on("enter",(function(){r||(!function(){let e=0;for(let t=1;t<=n;t++){const o=new Image;o.src=a(t),o.onload=()=>{e++;const t=Math.round(e/n*100);console.log(`Chargement : ${t}%`),$(".loading #value").html(t+"%"),e===n&&r()},i.push(o)}const r=()=>{$(".loading").remove(),t.width=i[0].width,t.height=i[0].height,o.drawImage(i[0],0,0);const e=()=>{const e=i[Math.floor(s.frame)];e&&(o.clearRect(0,0,t.width,t.height),o.drawImage(e,0,0))};gsap.registerPlugin(ScrollTrigger),gsap.to(s,{frame:449,snap:"frame",ease:"power1.inOut",scrollTrigger:{trigger:"#canvas-container",start:"top top",end:"+=9000",scrub:1,pin:!0,markers:!1},onUpdate:e})}}(),r=!0)})).addTo(e);let c=!1,d=null;function l(e){e.addClass("is-flipped");const t=e[0].getBoundingClientRect(),o=$(window).width(),n=$(window).height(),a=(o-t.width)/2,i=(n-t.height)/2,s=.95*o,r=.75*n/t.height,l=s/t.width,p=Math.min(r,l);$("body").addClass("overflow-hidden"),e.css("z-index",39),e.parent().css("z-index",39),e.parent().parent().css({"z-index":39,position:"relative"}),gsap.to(e,{duration:.5,x:a-t.left,y:i-t.top,scale:p,ease:"power2.out"}),c=!0,d=e}$(".card").on("click",(function(){const e=$(this),t=e.parent(),o=t.parent();if(t.css("z-index",1e3),e.css("z-index",1e3),o.css({"z-index":1e3,position:"relative"}),d&&d[0]!==e[0]){const t=d.parent(),o=t.parent();d.removeClass("is-flipped"),gsap.to(d,{duration:.5,x:0,y:0,scale:1,ease:"power2.out",onComplete:function(){d.css("z-index",""),t.css("z-index",""),o.css({"z-index":"",position:""}),d=null,l(e)}})}else c?(e.removeClass("is-flipped"),gsap.to(e,{duration:.5,x:0,y:0,scale:1,ease:"power2.out",onComplete:function(){e.css("z-index",""),t.css("z-index",""),o.css({"z-index":"",position:""}),$("body").removeClass("overflow-hidden"),c=!1,d=null}})):l(e)})),$(".card").on("mouseenter",(function(){const e=$(this);d&&d[0]===e[0]||gsap.to(e,{duration:.1,y:-10,ease:"power2.out"})})),$(".card").on("mouseleave",(function(){const e=$(this);d&&d[0]===e[0]||gsap.to(e,{duration:.1,y:0,ease:"power2.out"})})),$(".card .back button").on("click",(function(){$(this).parent().parent().removeClass("is-flipped")})),window.ScrollTrigger&&ScrollTrigger.create({trigger:"#canvas-container",start:"top bottom",end:"bottom top",onEnter:()=>{$(".card").parent().removeClass("is-rotated")},onEnterBack:()=>{$(".card").parent().removeClass("is-rotated")},onLeave:()=>{$(".card").parent().addClass("is-rotated")},onLeaveBack:()=>{$(".card").parent().addClass("is-rotated")}}),$(window).width()<767&&($(".encart").addClass("is-hidden"),$(".encart-txt").text("Ouvrir")),$("#encart-btn").on("click",(function(){$(".encart").toggleClass("is-hidden"),$(".encart").hasClass("is-hidden")?$(".encart-txt").html("Ouvrir"):$(".encart-txt").html("RÃ©duire")}))}));var e=new ScrollMagic.Controller,t=$("body"),o=new TimelineMax({paused:!0}).to(t,.15,{autoAlpha:1,ease:Power4.easeInOut});$("audio").audioPlayer(),(new TimelineMax).set(t,{autoAlpha:0})}(jQuery);